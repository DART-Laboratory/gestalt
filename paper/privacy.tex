\section{Analysis of Privacy Protection}
\label{privacy}


%\wajih{Use macros for common words in this whole section.}

%\wajih{Be consistent with the terminology that you used in the abstract/intro.}

%\wajih{Make subsections if possible}

%\wajih{Look at Page 9 of the paper: "A federated graph neural network framework for privacy-preserving personaliz..." to see what to write here. }

%\wajih{If you read other privacy and FL paper you will similar sections/subsections in their paper. You can look at them to get some inspiration. Since we don't show in experiments that privacy is preserved. We need to theoretically prove that privacy is preserved. }

In this section, we analyze the preservation of user privacy within \(\Sys\), which is structured around three primary components: central server, utility server, and clients. The central server's role involves the application of federated averaging to the \(\gnnshort\) models received from clients.

The utility server performs contextual aggregation of semantic attribute vectors derived from clients' \(\wordvec\) models. The aggregation process can be represented as:
\[ V_{agg} = f(V_1, V_2, ..., V_n) \]
where \(V_{agg}\) denotes the aggregated vector, \(V_1, V_2, ..., V_n\) are the semantic attribute vectors from each client, and \(f\) is a mean aggregation function.

Clients are tasked with training the \(\wordvec\) and \(\gnnshort\) models on provenance graphs, these graphs are constructed from their local system audit logs. 

Within \(\Sys\), potential privacy compromises arise if either the central or utility server can infer specific details about individual clients' logs, such as the applications in use or particular attributes like filenames and IP addresses. Despite the central server's inability to access raw client data directly, it receives model updates from clients, thereby introducing a vulnerability to model inference attacks through analysis of these updates. Consider an attacker's objective to ascertain whether a system entity \(x\) with attributes \(y\) was utilized in training a client model \(m\). This necessitates the generation of multiple candidate node features for \(x\), taking into account various graph structures and interactions with other entities while considering diverse attributes. The search space for this task, \(S\), is extensive, spanning all conceivable processes, files, and network IPs. 

Assuming the server generates multiple candidate structures, it then requires access to the specific client's \(\wordvec\) model to generate feature vectors for these structures—a step prevented by the model's unavailability and inherent algorithmic randomness, rendering each training iteration of the \(\wordvec\) model distinct:
\[ F(x) = \wordvec(s_x) \]
where \(F(x)\) is the feature vector of structure \(x\) and \(s_x\) is the candidate sequence.

Consequently, the dual-server architecture and semantic featurization significantly limits the central server's capacity for inference attacks. The utility server's function of contextually aggregating semantic attribute vectors introduces another potential privacy concern if the server could deduce the entities these vectors represent. This risk is mitigated by the secure encryption of tokens using keys generated by the central server, which the utility server cannot access, ensuring privacy protection:
\[ V_{enc} = \text{Encrypt}(V_{agg}, K) \]
where \(V_{enc}\) is the encrypted aggregated vector, and \(K\) is the encryption key generated by the central server.

Furthermore, a malicious client attempting to utilize the global aggregate to infer the applications used across the organization faces similar constraints. Such an attack is limited by the client's lack of access to the semantic attribute vectors widespread across the organization, significantly narrowing the attack's feasibility. Therefore, the architecture of \(\Sys\) robustly defends against model inference attacks, affirming the system's capacity to preserve privacy. This resilience is predicated on the non-collusion assumption between the central and utility servers—a standard premise upheld by related works~\cite{roy2020crypte,wu2022federated}, thereby ensuring the system's high degree of privacy preservation.