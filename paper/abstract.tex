\begin{abstract}
    Enterprises increasingly rely on Intrusion Detection Systems (IDS) to detect malicious threats through log analysis. However, centralizing logs, which often contain sensitive data (e.g., URLs), raises serious privacy and scalability concerns. We present \Sys, the first privacy-preserving Provenance-based IDS (\pids) that integrates Federated Learning (FL) with graph representation learning, achieving comparable detection accuracy while preserving user privacy and improving scalability. Building \Sys is non-trivial due to challenges in federating graph-based models across clients with heterogeneous logs, inconsistent semantic encodings, and temporally misaligned data. To address these, \Sys introduces a novel process entity categorization-based ensemble framework, where specialized submodels capture distinct system activity patterns and avoid conflation during aggregation. Since semantically rich encodings are essential for high detection accuracy, but encoders like \wordvec hinder private aggregation, we design a harmonization framework using a dual-server architecture: one server issues encryption keys for client-level log attributes, while the other securely aggregates encrypted data without revealing sensitive tokens. We further present a formal privacy analysis of \Sys's architecture, demonstrating strong protections against various attacks. Evaluations on DARPA E3, E5, and OpTC datasets show that \Sys matches the detection accuracy of state-of-the-art centralized systems, reduces network communication costs by 170$\times$, processes datasets in minutes rather than hours, and remains robust against adversarial threats.
    \end{abstract}
    
    

% Data provenance transforms \logs logs into detailed provenance graphs, offering a better understanding of host activities. When combined with Graph Neural Networks (GNNs) and FL, it becomes a powerful technique for differentiating benign from malicious behaviors.

% We have designed a multi-server architecture and a robust encryption scheme to preserve the privacy of important user log attributes. To address the challenges of non-IID data distributions, heterogeneous, and imbalanced clients, we implement a sophisticated GNN learning framework personalized at the system entity level. We also present a detailed analysis of our system's resilience against adversarial attacks. Extensive evaluation of our system on real-world datasets from DARPA demonstrates that it achieves state-of-the-art detection performance while being highly scalable and privacy-preserving.