\begin{abstract}

    Enterprises increasingly rely on Intrusion Detection Systems (IDS) to detect malicious threats via log analysis. However, centralizing logs, which often contain sensitive data (e.g., URLs), raises serious privacy concerns. We present \Sys, the first privacy-preserving Provenance-based IDS (\pids) that integrates Federated Learning (FL) with graph representation learning. \Sys trains locally on client machines, ensuring raw logs remain decentralized. Applying FL in \pids introduces challenges, such as non-IID data distributions and client heterogeneity, which can degrade global model performance. To address this, \Sys uses a novel process entity categorization-based ensemble framework, where specialized submodels capture distinct system activity patterns, avoiding conflation during aggregation. Since semantically rich encodings are essential for high detection accuracy, but encoders like \wordvec hinder private aggregation, we design a harmonization framework within a dual-server architecture: one server issues encryption keys for client-level log attributes, while the other securely aggregates encrypted data without revealing sensitive tokens. Evaluations on DARPA E3, E5, and OpTC datasets show that \Sys matches state-of-the-art detection accuracy, reduces network communication costs by 170$\times$, and scales to process datasets in minutes versus hours required by centralized \pids.

    \end{abstract}
    

% Data provenance transforms \logs logs into detailed provenance graphs, offering a better understanding of host activities. When combined with Graph Neural Networks (GNNs) and FL, it becomes a powerful technique for differentiating benign from malicious behaviors.

% We have designed a multi-server architecture and a robust encryption scheme to preserve the privacy of important user log attributes. To address the challenges of non-IID data distributions, heterogeneous, and imbalanced clients, we implement a sophisticated GNN learning framework personalized at the system entity level. We also present a detailed analysis of our system's resilience against adversarial attacks. Extensive evaluation of our system on real-world datasets from DARPA demonstrates that it achieves state-of-the-art detection performance while being highly scalable and privacy-preserving.