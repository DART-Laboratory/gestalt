\begin{abstract}

    Enterprises increasingly rely on Intrusion Detection Systems (\ids) to guard against malicious threats, utilizing \logs for detecting such activities. However, the common practice of centrally managing these logs, which include sensitive data such as IP addresses and file activities, raises privacy concerns, particularly when Managed Security Service Providers (MSSPs) are involved. These third parties, which offer essential services like intrusion detection, may inadvertently breach user privacy when storing and analyzing these sensitive logs in the cloud.

    Addressing these challenges, our system \Sys integrates Federated Learning (FL) with Graph Representation Learning, allowing clients to train models locally on their \logs without sharing data with a central entity. This approach ensures a scalable, decentralized, and privacy-centric \ids.

    
    %\wajih{Remove this sentence with all the challenges in one sentence, describe one challenge at a time and describe your novel solution. For example, To tackle the issue of blah blah, we propose blah blah. To address blah blah, we leverage blah blah}
    However, the application of FL presents several challenges. In a FL setting, data distribution and volume can significantly vary among participating clients, complicating the generalization of the global model across diverse heterogeneous patterns. To address this, we introduce a novel ensemble learning approach and a process entity categorization scheme, where each submodel specializes in distinct system activity patterns across clients, thus preventing conflation during model aggregation.

    The use of semantically rich feature vectors is crucial for achieving high detection performance. However, semantic encoders such as \wordvec contain sensitive log attributes, complicating private aggregation on a central server in a FL scenario. To address this, we developed a sophisticated \wordvec harmonization framework using a multi-server architecture for secure private aggregation of semantic attributes. One server generates encryption keys for client-level log attributes, while another performs computations on the encrypted data without revealing the sensitive tokens.

    %\wajih{Make sure to use the like we designed a novel Semantic word harmonization and we built sophisticated process entity categorization. Don't need to capitalize Graph Neural Network unless you put (GNN) against it.}
    
    Extensive evaluations on DARPA E3, E5, and OpTC datasets show that our system achieves state-of-the-art detection accuracy, while being highly scalable, efficient and privacy-preserving.
\end{abstract}

% Data provenance transforms \logs logs into detailed provenance graphs, offering a better understanding of host activities. When combined with Graph Neural Networks (GNNs) and FL, it becomes a powerful technique for differentiating benign from malicious behaviors.

% We have designed a multi-server architecture and a robust encryption scheme to preserve the privacy of important user log attributes. To address the challenges of non-IID data distributions, heterogeneous, and imbalanced clients, we implement a sophisticated GNN learning framework personalized at the system entity level. We also present a detailed analysis of our system's resilience against adversarial attacks. Extensive evaluation of our system on real-world datasets from DARPA demonstrates that it achieves state-of-the-art detection performance while being highly scalable and privacy-preserving.