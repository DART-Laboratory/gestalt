\begin{abstract}

    Enterprises increasingly rely on Intrusion Detection Systems (IDS) to detect malicious threats through log analysis. However, centralizing logs, which often contain sensitive data (e.g., URLs), raises significant privacy concerns. We present \Sys, the first privacy-preserving Provenance-based IDS (\pids) that integrates Federated Learning (FL) with graph representation learning to address these challenges. Unlike traditional systems, \Sys trains locally on client machines, ensuring sensitive logs remain decentralized. However, applying FL in \pids introduces unique challenges, including non-IID data distributions and client heterogeneity, which can degrade the performance of the global model. To overcome these issues, \Sys incorporates a novel ensemble learning framework and process entity categorization scheme, where specialized submodels learn distinct system activity patterns, preventing conflation during aggregation. Semantically rich feature vectors are essential for high detection accuracy; however, semantic encoders like \wordvec complicate private aggregation on a central server in the FL process. To overcome this, we developed a \wordvec model harmonization framework within dual-server architecture that securely aggregates semantic attributes. One server generates encryption keys for client-level log attributes, while another performs computations on encrypted data without revealing sensitive tokens. Extensive evaluations on DARPA E3, E5, and OpTC datasets show that \Sys achieves state-of-the-art detection accuracy while reducing network communication costs by 170-fold and scaling efficiently to process datasets in minutes, compared to the hours required by centralized \pids.
\end{abstract}

% Data provenance transforms \logs logs into detailed provenance graphs, offering a better understanding of host activities. When combined with Graph Neural Networks (GNNs) and FL, it becomes a powerful technique for differentiating benign from malicious behaviors.

% We have designed a multi-server architecture and a robust encryption scheme to preserve the privacy of important user log attributes. To address the challenges of non-IID data distributions, heterogeneous, and imbalanced clients, we implement a sophisticated GNN learning framework personalized at the system entity level. We also present a detailed analysis of our system's resilience against adversarial attacks. Extensive evaluation of our system on real-world datasets from DARPA demonstrates that it achieves state-of-the-art detection performance while being highly scalable and privacy-preserving.